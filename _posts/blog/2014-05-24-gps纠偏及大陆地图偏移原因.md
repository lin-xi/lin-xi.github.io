---
layout: post
title: gps纠偏及大陆地图偏移原因
description: 随着低版本IE份额下降，以及移动端流量的增长，在项目中也可以大胆使用CSS3动画来增强体验和提高产品的优雅程度，对那些不支持的浏览器也不用再费心去做更多兼容，所以，我们来研究下CSS3动画，到底应该怎么用。
category: blog
---

##大陆地图偏移原因：

国家安全与地图保密插件：国家保密插件，也叫做加密插件或者加偏或者SM模组，其实就是对真实坐标系统进行人为的加偏处理，按照几行代码的算法，将真实的坐标加密成虚假的坐标，而这个加偏并不是线性的加偏，所以各地的偏移情况都会有所不同。而加密后的坐标也常被人称为火星坐标系统，这是我们的国家又一个伟大的发明，让国外的政府和企业等，都看不懂我们的坐标系统。

民间纠编地图可能引起很严重的国家安全刑事问题

#1、偏移的起因：天朝测绘局以国家安全为理由，用法律的形式对所有在天朝发行的地图类产品加了强制性规范，要求所有地图类产品都必须使用国家测绘局的一种加偏移的算法，对地图的真实坐标进行加偏移处理，之后才可能通过审批准许上市。因此，天朝的所有官方及商用地图的坐标都是偏移的，这种偏移属于非线性的，偏移量在300至500米不等，偏移方向也不定。这种加过偏移的地图坐标就是所谓“火星坐标”。
#2、GPS接收机本身接收卫星的信号，计算出本机所在位置的经纬度，在没有做特别处理的时候，这个经纬度是正确的。但是如果GPS支持加载地图的话，这个GPS中的地图就得受上述第一条法规的约束了，所以正式在天朝销售的行货GPS设备中的地图必须也得加偏移，处理成火星坐标。
#3、问题来了，如果仅仅是地图搞成火星坐标，但GPS仍然输出真实坐标的话，就会发生GPS的定位（及导航）跟地图不能吻合的问题。于是，只好在GPS软件中设置一个使用同样算法的加偏移功能。GPS先从卫星上得到真实坐标，然后经过加偏移程序转换成火星坐标，由于是同一个算法，所以经过软件加偏移的坐标能跟同样加了偏移的地图吻合，就是“歪到一起”了。这样就可以用GPS正常导航了——但这台GPS设备输出的坐标仍然是火星坐标，放到Google Earth上面是没法正常吻合的。
#4、由于Google Earth属于卫星照片，它不是地图，所以不受天朝测绘法的约束，因此Google Earth的坐标是真实坐标。这样，问题又来了，当你使用天朝处理过的GPS导出火星坐标（或航迹），企图把它放到Google Earth上面看看自己都走了哪些路的时候，因为Google Earth照片的坐标是真实的，而你的GPS导出的坐标是火星坐标，二者就对不上号了，你也许会看到在google Earth上，你开着车从别人的楼顶上飞过去，或者打湖里面漂过去。
#5、水货GPS因为是洋鬼子的产品，原本并非销往天朝的，洋鬼子不会玩这种加偏移的买卖，所以水货GPS设备，如果使用机器原带的地图的话，得到的坐标（或者航迹）是真实正确的，这就是水货机器的无偏地图。但是洋鬼子的设备中一般没有中文地图，如果你把天朝的官方或者正式发布的商用地图放到水货GPS设备里面的话，就会发生第3条前面说的问题：设备的真实坐标跟天朝特殊地图的火星坐标不吻合——出现偏移——无法正常导航。
#6、由于火星坐标的一系列问题，众民间人士根据那个加偏移算法自行折腾出了很多纠正了偏移的地图，这些地图的坐标是正确的。这样的地图拿到水货GPS设备上，因为水货GPS输出的坐标是真实的，所以可以完美配合工作，正确导航定位，并且输出正确的坐标——放到Google Earth上也是正确的。
#7、天朝行货GPS设备软件中的加偏移功能，是通过一个所谓空心地图文件（或者28类地图，或者快拼模块）来触发启动偏移程序的，如果用户安装非本机自带的，但属于天朝官方或者正式发布的商用地图，那要配合空心地图文件（或者把地图类别设置为28），从而让GPS软件中的加偏移程序启动，使得GPS输出火星坐标，跟地图的火星坐标吻合，如此才能正常导航——但这台GPS设备输出的坐标仍然是火星坐标，放到Google Earth上面是没法正常吻合的。
#8、天朝行货GPS设备，如果要得到真实坐标，使用民间的纠偏地图，就得把那个空心地图文件移除（或把原机自带的28类地图移除/取消，或把同样作用的快拼弄掉），这样GPS设备输出真实的坐标，才能跟纠偏地图的正确坐标吻合，实现正确导航定位，并且输出正确的坐标——放到Google Earth上也是正确的。不过，在天朝行货GPS上不能同时使用火星坐标地图和纠偏地图，否则必然有一个没法正常导航定位。
#9、水货GPS设备用民间的简体中文刷机，一般来说也没有那个加偏移程序，所以要使用纠偏地图或者无偏地图。不能使用天朝官方的火星坐标地图，不然就对不上号。
  其实很少有人知道国家保密插件问题，但作为导航电子地图产业或者汽车导航产业中的人，多多少少都会了解到这个问题。国家是出于国家安全考虑，将我们看到的真实的坐标变成假的虚拟的坐标，这样，我们的国家就安全了，不会被恐怖分子破坏了。最简单的举例来说，比如鸟巢吧，你真实的坐标是这个，加密后就成了那个，导航电子地图上看到的就是那个，那么人家导弹要是攻击那个的时候，那么导弹就打不中我们的鸟巢啦，我们的鸟巢就安全了。不过，个人担心这样加密后没有打中鸟巢，会不会打中水立方呢，可能是无心插柳柳成荫了。

 具体说说这个保密插件的问题吧，是如何运作的呢？

   现在，所有的电子地图所有的导航设备，都需要加入国家保密插件。第一步，地图公司测绘地图，测绘完成后，送到国家测绘局，将真实坐标的电子地图，加密成“火星坐标”，这样的地图才是可以出版和发布的，然后才可以让GPS公司处理。第二步，所有的GPS公司，只要需要汽车导航的，需要用到导航电子地图的，统统需要在软件中加入国家保密算法，将COM口读出来的真实的坐标信号，加密转换成国家要求的保密的坐标，这样，GPS导航仪和导航电子地图就可以完全匹配啦，GPS也就可以正常工作啦。

   所以，所有的导航电子地图公司，像四维图新、瑞图、易图通、高德等等，都需要将自己的电子地图拿到国家测绘局进行加密处理，而所有的导航软件公司，都需要将自己的导航软件中加入国家测绘局提供的加密算法的代码。而这一段代码，就是国家的机密，不是公开的，每次去国家测绘局加密处理都需要预约并在封闭的环境中进行，编译完成后需要是在主程序的exe中，而不能编译在外部dll等文件中。

   当然，国家的保密插件，是需要收费的，早期的时候，一个导航仪就需要10块钱的保密插件许可费，恩，保密插件也不是白用的，毕竟国家花了很多的钱和人力和物力才做出来的保护国家安全的保密东西怎么可以随便送你用呢，收点钱也就算是正常也算是在预料之中啦。现在的话，好像已经下放到地图数据公司了，就是看这个地图数据公司的经营状况，大概会出货多少份电子地图，然后一次性收取地图数据公司多少钱，可能是多少百万，然后这个钱呢，你们数据公司就自己找你们的导航软件公司的客户收吧，算在每一台设备中的许可费，恩，国家的办事效率变高了，一次直接从导航电子地图公司收费比逐个收取导航软件公司的钱要来的容易和不那么麻烦。

现阶段，有些人或者组织，为了自己的利益，将导航软件和导航地图进行破解，并发现了导航电子地图中存在的地图偏差，所以就采取人为的手段，将地图反加密，将虚假的坐标转换成标准的WGS84坐标，最笨的方法就是线性的平移，大概偏差的距离为500米，基本上能够反回来，但误差较大，特别是南北距离加大的情况下，而聪明一点的方法，用matlab等工具计算出其中的曲线，然后反转回来。多么的可怕那，这是触犯国家法律的行为，国家的安全就这样被你们破坏了，这是一个刑事问题，而不是简单的破解软件破解地图的经济犯罪问题了。请大家务必务必遵守国家的法律，不要干出这样的傻事出来，出了事谁都保不了你，毕竟你将成为国家的敌人。

   最后，说说保密插件带来的弊端，好处不容忽视，国家为了安全考虑，保密了就安全了，但弊端是，制造了人为的障碍，非常的不好用，比如导航软件出来的坐标，不能和Google Earth等国际软件匹配，Google Earth和Map在国内基本上就是废物。进一步带来的导航问题是，寻宝、分享等许多好玩的GPS活动，都无法在大陆地区展开，这一点真的让人很无奈。当然，也有一些时候，由于导航软件的保密插件问题，导致不能导航等等。保密插件，是一个让人哭笑不得的东西，就如同国际的WGS84坐标对我们的54坐标或者80坐标，就如同最近的国家部门准备开发“影像中国”反制google earth的泄密问题。等等种种，法律不可逾越，但我们也不希望人为的制造麻烦，或者为了更深入的经济利益。



